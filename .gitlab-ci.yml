# https://docs.gitlab.com/ce/ci/yaml/README.html

stages:
  - build
  - test
  - deploy

before_script:
  - echo "before script"
  - pwd
  - ls -la
  - hostname
  
build1:
  stage: build
  tags:
    - osx
  script:
    - pwd
    - ls -la
    - "go build -o binaries/narcotk-hosts-${CI_COMMIT_REF_NAME} main.go"
    - ls -la
  artifacts:
    name: "${CI_JOB_NAME}_${CI_COMMIT_REF_NAME}"
    untracked: true
    paths:
      - binaries/*

test1:
  stage: test
  tags:
    - osx
  script:
    - pwd
    - ls -la
    - go fmt main.go
    - "./binaries/narotk-hosts-${CI_COMMIT_REF_NAME} --help"

deploy1:
  stage: deploy
  tags:
    - osx
  script:
    - echo "deploy stage"
